<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="csns">
	<select id="list" parameterType="cs" resultType="cs">
		select * from cs order by num
	</select>
	
	<select id="getTotal" parameterType="cs" resultType="integer">
		select count(*) from cs
	</select>
	
	<select id="select" parameterType="integer" resultType="cs">
		select * from cs where num=#{num}
	</select>
	
	<select id="selectM" parameterType="integer" resultType="member">
		select * from member where m_num=#{m_num}
	</select>
	
	<select id="maxNum" resultType="integer">
		<!-- ref와 num을 구분하기 위해서 -->
		select nvl(max(num), 0) + 1 from cs
	</select>
	
	<update id="updateStep" parameterType="cs">
		update cs set cs_re_step = cs_re_step + 1 where cs_ref=#{cs_ref} and cs_re_step > #{cs_re_step}
	</update>
	
	<insert id="insert" parameterType="cs">
		insert into cs values (#{num},#{cs_title},sysdate,#{cs_content},
			0,#{cs_ref},#{cs_re_step},#{cs_re_level},#{m_num})
	</insert>
	
</mapper>