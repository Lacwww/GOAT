<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="schedulens">
	<!-- 전체 지역 리스트 조회 -->
	<select id="areaList" resultType="area">
		select * from area
	</select>
	
	<!-- 해당 지역 상세 설명 조회 -->
	<select id="areaSelect" parameterType="string" resultType="area">
		select * from area where place_area = #{place_area}
	</select>
	
	<!-- 해당 지역 플레이스 리스트 조회 -->
	<select id="placeList" parameterType="place" resultType="place">
		select * from place where place_area=#{place_area}
			<if test="keyword != null and keyword !='' ">
				and ${search} like '%'||#{keyword}||'%'
			</if>
	</select>
	<!-- 선택한 플레이스 조회 -->
	<select id="pick_place" parameterType="integer" resultType="place">
		select * from place where place_num=#{id}
	</select>   
	<!-- 여행 기간 구하기 -->
	<select id="days" parameterType="hashmap" resultType="integer">
		select to_date(#{e_date},'yyyy-mm-dd')-to_date(#{s_date},'yyyy-mm-dd')+1 FROM DUAL
	</select>
	<!-- 스케줄 생성 -->
 	<insert id="insert" parameterType="sc">
		insert into schedule  values ((SELECT NVL(MAX(sch_num),0)+1 FROM schedule), #{sch_name},#{s_date},#{e_date},#{m_num})
	</insert>
	<select id="select_num" resultType="integer">
		SELECT NVL(MAX(sch_num),1) FROM schedule
	</select>
	<!-- 스케줄 상세내역 생성 -->
	<insert id="insertDetail" parameterType="scd">
		insert into schedule_detail values((SELECT NVL(MAX(schd_num),0)+1 FROM schedule_detail),#{day},'자동차',#{sch_num},#{place_num})
	</insert>
	
</mapper>